# 动态消息队列

动态消息队列模块在直播场景中扮演着重要角色，为数字人面对大量弹幕消息提供了有效且有序的消息处理方式。

## 设计思路

在项目中，结合**语义**和**时间**信息，该模块能够对来自用户和系统的数据进行重排序，以提高处理效率并确保消息的有序性和及时性。同时，通过语义分析和优先级处理，该模块能够为数字人提供更智能、个性化的回应。

一方面，对于与主题高度相关的消息，它们将被优先处理，以便数字人能够提供更有针对性的回应。而与主题无关的消息则会按照时间顺序进行处理，保证消息的有序性。在具体实现中，动态消息队列模块利用LLM模块中的Vector Similarity检索器来检索直播间弹幕消息与“百年校庆”主题的相关性。通过计算弹幕消息与主题之间的语义相似度，可以确定弹幕消息是否与主题相关。

另外一方面，对于直播信息，时效性也很重要。动态消息队列模块能够根据消息的时间信息，确保及时处理最新的消息。较新的消息将被优先处理，以保持与实时直播内容的同步性。

总而言之，动态消息队列模块为数字人提供更智能、个性化的回应，从而提升用户体验并使直播间的弹幕互动更加高效和有趣。


## 具体实现

我们提供了两种实现方式：

* 基于语义分级的先入先出动态消息队列（MSQueue）
* 基于语义和时间感知的动态消息队列（TAMQueue）

其中，TAMQueue适用于弹幕消息较少时，MSQueue适用于弹幕消息较多时。
